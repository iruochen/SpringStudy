## AOP 相关术语

- Target(目标对象)：代理的目标对象
- Proxy(代理)：一个类被AOP织入增强后，就产生一个结果代理类
- Joinpoint(连接点)：所谓连接点是指那些被拦截到的点。在spring中，这些点指的是方法，因为spring只支持方法类型的连接点
- **Pointcut**(切入点)：所谓切入点是指我们要对哪些 Joinpoint 进行拦截的定义

> `Joinpoint`：可以被增强的方法
> `Pointcut`：配置真正被增强的方法

- **Advice**(通知/增强)：所谓通知是指被拦截到 Joinpoint 之后所要做的事情就是通知
- **Aspect**(切面)：是切入点和通知（引介）的结合
- **Weaving**(织入)：是指把增强应用到目标对象来创建新的代理对象的过程。spring 采用动态代理织入，而 AspectJ 采用编译器织入和类加载期织入（切点和通知结合的过程）

## AOP 开发明确事项

- 需要编写的内容
    - 编写核心业务代码（目标类的目标方法）
    - 编写切面类，切面类中有通知（增强功能方法）
    - 在配置文件中，配置织入关系，即将哪些通知与哪些连接点进行结合
- AOP 技术实现的内容
    - Spring 框架监控切入点方法的执行。一旦监控到切入点方法被运行，使用代理机制，动态创建目标对象的代理对象，根据通知类别， 在代理对象的对应位置，将通知对应的功能织入，完成完整的代码逻辑运行
- AOP 底层使用哪种代理方式
    - 在 spring 中，框架会根据目标类是否实现了接口来决定采用哪种动态代理的方式

## AOP 知识要点

- aop：面向切面编程
- aop底层实现；基于JDK的动态代理和基于cglib的动态代理
- aop的重点概念
    - Pointcut(切入点)；被增强的方法
    - Advice(通知/增强)：封装增强业务逻辑的方法
    - Aspect(切面)：切点+通知
    - Weaving(织入)：将切点与通知结合的过程
- 开发明确事项
    - 谁是切点（切点表达式配置）
    - 谁是通知（切面类中的增强方法）
    - 将切点和通知进行织入配置

## 基于XML的AOP开发

- 开发步骤
    - 导入 AOP 相关坐标
    - 创建目标接口和目标类（内部有切点）
    - 创建切面类（内部有增强方法）
    - 将目标类和切面类的对象创建权交给 spring
    - 在 `applicationContext.xml` 中配置织入关系
    - 测试代码

### XML 配置 AOP 详解

- 切点表达式的写法
  `execution([修饰符] 返回值类型 包名.类名.方法名(参数))`
    - 访问修饰符可以省略
    - 返回值类型、包名、类名、方法名可以使用星号(\*)代表任意
    - 包名与类名之间一个点(.)代表当前包下的类，两个点(.)表示当前包及其子包下的类
    - 参数列表可以使用两个点(..)表示任意个数，任意类型的参数列表

### 通知类型

| 名称 | 标签 | 说明 |
| - | - | - |
| 前置通知 | <aop:before> | 用于配置前置通知。指定增强的方法在切入点方法之前执行 |
| 后置通知 | <aop:after-returning> | 用于配置后置通知。指定增强的方法在切入点方法之后执行 |
| 环绕通知 | <aop:around> | 用于配置环绕通知。指定增强的方法在切入点方法之前和之后都执行 |
| 异常抛出通知 | <aop:throwing> | 用于配置异常抛出通知。指定增强的方法在出现异常时执行 |
| 最终通知 | <aop:after> | 用于配置最终通知。无论增强方法执行是否有异常都会执行 |

## 基于注解的 AOP 开发
- 开发步骤
  - 创建目标接口和目标类（内部有切点）
  - 创建切面类（内部有增强方法）
  - 将目标类和切面类的对象创建权交给 Spring
  - 在切面中使用注解配置织入关系
  - 在配置文件中开启组件扫描和 AOP 的自动代理
  - 测试